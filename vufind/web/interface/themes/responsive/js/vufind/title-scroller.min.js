function TitleScroller(scrollerId,scrollerShortName,container,autoScroll,style){this.scrollerTitles=[];this.currentScrollerIndex=0;this.numScrollerTitles=0;this.scrollerId=scrollerId;this.scrollerShortName=scrollerShortName;this.container=container;this.scrollInterval=0;this.swipeInterval=5;if(typeof autoScroll=="undefined"){this.autoScroll=false}else{this.autoScroll=autoScroll}if(typeof style=="undefined"){this.style="horizontal"}else{this.style=style}}TitleScroller.prototype.loadTitlesFrom=function(jsonUrl){jsonUrl=decodeURIComponent(jsonUrl);var scroller=this;var scrollerBody=$("#"+this.scrollerId+" .scrollerBodyContainer .scrollerBody");scrollerBody.hide();$("#titleScrollerSelectedTitle"+this.scrollerShortName).html("");$("#titleScrollerSelectedAuthor"+this.scrollerShortName).html("");$(".scrollerLoadingContainer").show();$.getJSON(jsonUrl,function(data){scroller.loadTitlesFromJsonData(data)}).error(function(){scrollerBody.html("Unable to load titles. Please try again later.");scrollerBody.show();$(".scrollerLoadingContainer").hide()})};TitleScroller.prototype.loadTitlesFromJsonData=function(data){var scroller=this;var scrollerBody=$("#"+this.scrollerId+" .scrollerBodyContainer .scrollerBody");try{if(data.titles.length==0){scrollerBody.html("No titles were found for this list. Please try again later.");$("#"+this.scrollerId+" .scrollerBodyContainer .scrollerLoadingContainer").hide();scrollerBody.show()}else{scroller.scrollerTitles=[];var i=0;$.each(data.titles,function(key,val){scroller.scrollerTitles[i++]=val});if(scroller.container&&data.titles.length>0){$("#"+scroller.container).fadeIn()}scroller.numScrollerTitles=data.titles.length;if(this.style=="horizontal"||this.style=="vertical"){scroller.currentScrollerIndex=data.currentIndex}else{scroller.currentScrollerIndex=0}TitleScroller.prototype.updateScroller.call(scroller)}}catch(err){if(scrollerBody!=null){scrollerBody.html("error loading titles from data "+err.description+". Please try again later.");scrollerBody.show();$(".scrollerLoadingContainer").hide()}else{}}};TitleScroller.prototype.updateScroller=function(){var scrollerBody=$("#"+this.scrollerId+" .scrollerBodyContainer .scrollerBody");try{var scrollerBodyContents="";var curScroller=this;if(this.style=="horizontal"){for(var i in this.scrollerTitles){scrollerBodyContents+=this.scrollerTitles[i]["formattedTitle"]}scrollerBody.html(scrollerBodyContents);scrollerBody.width(this.scrollerTitles.length*131);scrollerBody.waitForImages(function(){TitleScroller.prototype.finishLoadingScroller.call(curScroller)})}else if(this.style=="vertical"){for(var j in this.scrollerTitles){scrollerBodyContents+=this.scrollerTitles[j]["formattedTitle"]}scrollerBody.html(scrollerBodyContents);scrollerBody.height(this.scrollerTitles.length*131);scrollerBody.waitForImages(function(){TitleScroller.prototype.finishLoadingScroller.call(curScroller)})}else{this.currentScrollerIndex=0;scrollerBody.html(this.scrollerTitles[this.currentScrollerIndex]["formattedTitle"]);TitleScroller.prototype.finishLoadingScroller.call(this)}}catch(err){alert("error in updateScroller for scroller "+this.scrollerId+" "+err.description);scrollerBody.html("error loading titles from data "+err+". Please try again later.");scrollerBody.show();$(".scrollerLoadingContainer").hide()}};TitleScroller.prototype.finishLoadingScroller=function(){$(".scrollerLoadingContainer").hide();var scrollerBody=$("#"+this.scrollerId+" .scrollerBodyContainer .scrollerBody");scrollerBody.show();TitleScroller.prototype.activateCurrentTitle.call(this);var curScroller=this;$(".scrollerTitle").bind("mouseover",{scroller:curScroller},function(){curScroller.hovered=true}).bind("mouseout",{scroller:curScroller},function(){curScroller.hovered=false});curScroller.hovered=false;if(this.autoScroll&&this.scrollInterval==0){this.scrollInterval=setInterval(function(){if(!curScroller.hovered){curScroller.scrollToRight()}},5e3)}};TitleScroller.prototype.scrollToRight=function(){this.currentScrollerIndex++;if(this.currentScrollerIndex>this.numScrollerTitles-1)this.currentScrollerIndex=0;TitleScroller.prototype.activateCurrentTitle.call(this)};TitleScroller.prototype.scrollToLeft=function(){this.currentScrollerIndex--;if(this.currentScrollerIndex<0)this.currentScrollerIndex=this.numScrollerTitles-1;TitleScroller.prototype.activateCurrentTitle.call(this)};TitleScroller.prototype.swipeToRight=function(customSwipeInterval){customSwipeInterval=typeof customSwipeInterval==="undefined"?this.swipeInterval:customSwipeInterval;this.currentScrollerIndex-=customswipeInterval;if(this.currentScrollerIndex>this.numScrollerTitles-1)this.currentScrollerIndex=0;TitleScroller.prototype.activateCurrentTitle.call(this)};TitleScroller.prototype.swipeToLeft=function(customSwipeInterval){customSwipeInterval=typeof customSwipeInterval==="undefined"?this.swipeInterval:customSwipeInterval;this.currentScrollerIndex+=customswipeInterval;if(this.currentScrollerIndex<0)this.currentScrollerIndex=this.numScrollerTitles-1;TitleScroller.prototype.activateCurrentTitle.call(this)};TitleScroller.prototype.activateCurrentTitle=function(){if(this.numScrollerTitles==0){return}var scrollerTitles=this.scrollerTitles;var scrollerShortName=this.scrollerShortName;var currentScrollerIndex=this.currentScrollerIndex;$("#titleScrollerSelectedTitle"+scrollerShortName).html(scrollerTitles[currentScrollerIndex]["title"]);$("#titleScrollerSelectedAuthor"+scrollerShortName).html(scrollerTitles[currentScrollerIndex]["author"]);var scrollerBody=$("#"+this.scrollerId+" .scrollerBodyContainer .scrollerBody");$("#tooltip").hide();var scrollerTitleId="#scrollerTitle"+this.scrollerShortName+currentScrollerIndex;if(this.style=="horizontal"){if($(scrollerTitleId).length!=0){var widthItemsLeft=$(scrollerTitleId).position().left;var widthCurrent=$(scrollerTitleId).width();var containerWidth=$("#"+this.scrollerId+" .scrollerBodyContainer").width();var leftPosition=-(widthItemsLeft+widthCurrent/2-containerWidth/2);scrollerBody.animate({left:leftPosition+"px"},400,function(){for(var i in scrollerTitles){var scrollerTitleId2="#scrollerTitle"+scrollerShortName+i;$(scrollerTitleId2).removeClass("selected")}$(scrollerTitleId).addClass("selected")})}}else if(this.style=="vertical"){if($(scrollerTitleId).length!=0){var relativeTopOfElement=$(scrollerTitleId).position().top;var topPosition=25-relativeTopOfElement;scrollerBody.animate({top:topPosition+"px"},400,function(){for(var i in scrollerTitles){var scrollerTitleId2="#scrollerTitle"+scrollerShortName+i;$(scrollerTitleId2).removeClass("selected")}$(scrollerTitleId).addClass("selected")})}}else{scrollerBody.left="0px";scrollerBody.html(this.scrollerTitles[currentScrollerIndex]["formattedTitle"])}};(function($){$.fn.waitForImages=function(finishedCallback,eachCallback){eachCallback=eachCallback||function(){};if(!$.isFunction(finishedCallback)||!$.isFunction(eachCallback)){throw{name:"invalid_callback",message:"An invalid callback was supplied."}}var objs=$(this),allImgs=objs.find("img"),allImgsLength=allImgs.length,allImgsLoaded=0;if(allImgsLength==0){finishedCallback.call(this)}else{setTimeout(function(){finishedCallback.call(this)},1e4)}return objs.each(function(){var obj=$(this),imgs=obj.find("img");if(imgs.length==0){return}imgs.each(function(){var image=new Image,imgElement=this;image.onload=function(){allImgsLoaded++;eachCallback.call(imgElement,allImgsLoaded,allImgsLength);if(allImgsLoaded==allImgsLength){finishedCallback.call(obj[0])}return false};image.onabort=function(){allImgsLoaded++;eachCallback.call(imgElement,allImgsLoaded,allImgsLength);if(allImgsLoaded==allImgsLength){finishedCallback.call(obj[0])}return false};image.onerror=function(){allImgsLoaded++;eachCallback.call(imgElement,allImgsLoaded,allImgsLength);if(allImgsLoaded==allImgsLength){finishedCallback.call(obj[0])}return false};image.src=this.src})})}})(jQuery);